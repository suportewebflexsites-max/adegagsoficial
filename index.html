<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adega GS Oficial</title>

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#000;
  color:#fff;
}
header{
  padding:15px;
  border-bottom:1px solid #222;
}
h1{color:#d4af37;margin:0}
.badge{
  background:#2ecc71;
  padding:10px;
  text-align:center;
  font-weight:bold;
}
.section{padding:15px}
.product{
  background:#111;
  border-radius:10px;
  padding:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}
button{
  background:#2ecc71;
  border:none;
  padding:8px 14px;
  border-radius:8px;
  color:#000;
  font-weight:bold;
}
#cart{
  position:fixed;
  bottom:20px;
  right:20px;
  background:#2ecc71;
  color:#000;
  border-radius:50%;
  width:60px;
  height:60px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
}
#cartModal{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  padding:20px;
  overflow:auto;
}
input,select{
  width:100%;
  padding:10px;
  margin:6px 0;
  border-radius:8px;
  border:none;
}
.progress{
  height:10px;
  background:#333;
  border-radius:10px;
  overflow:hidden;
}
.progress div{
  height:100%;
  background:#2ecc71;
}
</style>
</head>

<body>

<!-- üîû MAIORIDADE -->
<div id="ageModal" style="position:fixed;inset:0;background:#000;z-index:9999;display:flex;align-items:center;justify-content:center">
  <div style="background:#111;padding:20px;border-radius:10px;text-align:center">
    <h2>üîû Aviso Legal</h2>
    <p>Voc√™ √© maior de 18 anos?</p>
    <button onclick="confirmAge(true)">SIM</button>
    <button onclick="confirmAge(false)">N√ÉO</button>
  </div>
</div>

<header>
  <h1>Adega GS Oficial</h1>
  <small>Rua Pl√°cido Parreira Lima, 142<br>11:00 √†s 00:00 ¬∑ 00:00 √†s 04:00</small>
</header>

<div class="badge">üéÅ Frete GR√ÅTIS para pedidos acima de R$ 120,00</div>

<div class="section" id="products"></div>

<div id="cart" onclick="openCart()">üõí</div>

<div id="cartModal">
  <h2>Meu Carrinho</h2>
  <div id="cartItems"></div>

  <p><b>Total:</b> R$ <span id="total">0.00</span></p>

  <div id="freteInfo"></div>
  <div class="progress"><div id="freteBar"></div></div>

  <p>Pedido m√≠nimo: R$ 20,00</p>

  <select id="pagamento">
    <option value="">Forma de pagamento</option>
    <option value="PIX">PIX</option>
    <option value="CREDITO">Cr√©dito</option>
    <option value="DEBITO">D√©bito</option>
  </select>

  <input placeholder="Nome">
  <input placeholder="Endere√ßo">
  <input placeholder="N√∫mero">
  <input placeholder="CPF">
  <textarea placeholder="Observa√ß√µes"></textarea>

  <button onclick="finalizar()">Finalizar pedido</button>
  <button onclick="closeCart()">Continuar comprando</button>
</div>

<script>
const PIX_CHAVE = "61.888.559/0001-94";
const WHATS = "5511981654980";
const FRETE_GRATIS = 120;
const ADEGA = {lat:-23.55052, lon:-46.633308};

let cart = {};
let userKM = 0;

const produtos = [
["Amstel 269ml",9],["Heineken 269ml",5.2],["Original 269ml",4],
["Skol 269ml",4],["Red Bull 250ml",10],["Carv√£o",18],
["Saco de Gelo",18],["Whisky Red Label 1L",99.99],
["Whisky Ballantines 1L",99.99],["Smirnoff 1L",42.5]
];

function renderProducts(){
  const p = document.getElementById("products");
  produtos.forEach(([n,v])=>{
    p.innerHTML += `
      <div class="product">
        <div>${n}<br><small>R$ ${v.toFixed(2)}</small></div>
        <button onclick="add('${n}',${v})">Adicionar</button>
      </div>`;
  });
}

function add(n,v){
  cart[n]=(cart[n]||0)+v;
  updateCart();
}

function updateCart(){
  let t=0;
  const ci=document.getElementById("cartItems");
  ci.innerHTML="";
  for(let i in cart){t+=cart[i];ci.innerHTML+=`<p>${i}</p>`}
  document.getElementById("total").innerText=t.toFixed(2);
  updateFrete(t);
}

function updateFrete(total){
  let bar=document.getElementById("freteBar");
  let info=document.getElementById("freteInfo");
  if(total>=FRETE_GRATIS){
    bar.style.width="100%";
    info.innerHTML="üéâ Frete gr√°tis aplicado";
  }else{
    let f=(FRETE_GRATIS-total).toFixed(2);
    bar.style.width=(total/FRETE_GRATIS*100)+"%";
    info.innerHTML=`üöö Faltam R$ ${f} para frete gr√°tis`;
  }
}

function openCart(){document.getElementById("cartModal").style.display="block"}
function closeCart(){document.getElementById("cartModal").style.display="none"}

function confirmAge(ok){
  if(!ok){alert("Acesso negado");location.reload()}
  document.getElementById("ageModal").style.display="none";
  getGPS();
}

function getGPS(){
  navigator.geolocation.getCurrentPosition(pos=>{
    userKM = calcKm(pos.coords.latitude,pos.coords.longitude);
  },()=>alert("GPS obrigat√≥rio"));
}

function calcKm(lat,lon){
  const R=6371;
  const dLat=(lat-ADEGA.lat)*Math.PI/180;
  const dLon=(lon-ADEGA.lon)*Math.PI/180;
  const a=Math.sin(dLat/2)**2+
  Math.cos(ADEGA.lat*Math.PI/180)*
  Math.cos(lat*Math.PI/180)*
  Math.sin(dLon/2)**2;
  return R*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)));
}

function finalizar(){
  const pag=document.getElementById("pagamento").value;
  if(!pag){alert("Escolha pagamento");return}
  let msg=`Pedido Adega GS\nTotal R$ ${document.getElementById("total").innerText}\n`;
  if(pag==="PIX") msg+=`PIX: ${PIX_CHAVE}`;
  else msg+="Pagamento via link (Cr√©dito/D√©bito)";
  window.open(`https://wa.me/${WHATS}?text=${encodeURIComponent(msg)}`);
}

renderProducts();
</script>
</body>
</html>
